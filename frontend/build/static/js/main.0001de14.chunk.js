(this.webpackJsonpfrontend=this.webpackJsonpfrontend||[]).push([[0],{42:function(e,t,n){},43:function(e,t,n){},81:function(e,t,n){"use strict";n.r(t);var a=n(0),c=n(1),o=n.n(c),r=n(33),s=n.n(r),i=(n(42),n(43),n(10)),u=n(3),l=function(){return Object(a.jsx)("div",{children:"HYome"})},p=n(5),h=n.n(p),j=n(2),d=n(11),b=n(13),f="LOGIN_SUCCESS",O="LOGIN_FAIL",g="LOAD_USER_SUCCESS",x="LOAD_USER_FAIL",m="AUTHENTICATE_SUCCESS",v="AUTHENTICATE_FAIL",y="LOGOUT",w="ACTIVATE_SUCCESS",S="ACTIVATE_FAIL",k={access:localStorage.getItem("access"),refresh:localStorage.getItem("refresh"),isAuthenticated:null,user:null,loginFailed:!1};function C(e,t){var n=t.type,a=t.payload;switch(n){case m:return Object(j.a)(Object(j.a)({},e),{},{isAuthenticated:!0});case f:return localStorage.setItem("access",a.access),localStorage.setItem("refresh",a.refresh),Object(j.a)(Object(j.a)({},e),{},{access:a.access,refresh:a.refresh,isAuthenticated:!0,loginFail:!1});case g:return console.log(g,a),Object(j.a)(Object(j.a)({},e),{},{user:a.user});case O:return Object(j.a)(Object(j.a)({},e),{},{isAuthenticated:!1,loginFail:!0});case w:case S:case v:case x:return Object(j.a)(Object(j.a)({},e),{},{isAuthenticated:!1,user:null});case y:return localStorage.removeItem("access"),localStorage.removeItem("refresh"),Object(j.a)({},k);default:return e}}var A=n(12),_=n.n(A),I="http://localhost:8000/auth/o/google-oauth2/?",T="http://localhost:8000/auth/o/facebook/?",E=o.a.createContext(),U=function(e){var t=e.children,n=Object(c.useReducer)(C,k),o=Object(b.a)(n,2),r=o[0],s=o[1],i=function(){var e=Object(d.a)(h.a.mark((function e(t,n){var a,c,o;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a={headers:{"Content-Type":"application/json"}},c=JSON.stringify({email:t,password:n}),e.prev=2,e.next=5,_.a.post("http://localhost:8000/auth/jwt/create/",c,a);case 5:o=e.sent,s({type:f,payload:Object(j.a)({},o.data)}),s(u()),e.next=14;break;case 10:e.prev=10,e.t0=e.catch(2),console.log(e.t0),s({type:O});case 14:case"end":return e.stop()}}),e,null,[[2,10]])})));return function(t,n){return e.apply(this,arguments)}}(),u=function(){var e=Object(d.a)(h.a.mark((function e(){var t,n;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!localStorage.getItem("access")){e.next=13;break}return t={headers:{"Content-Type":"application/json",Authorization:"JWT ".concat(localStorage.getItem("access")),Accept:"application/json"}},e.prev=2,e.next=5,_.a.get("http://localhost:8000/auth/users/me/",t);case 5:n=e.sent,s({type:g,payload:{user:n.data}}),e.next=13;break;case 9:e.prev=9,e.t0=e.catch(2),console.log(e.t0),s({type:x});case 13:case"end":return e.stop()}}),e,null,[[2,9]])})));return function(){return e.apply(this,arguments)}}(),l=function(){var e=Object(d.a)(h.a.mark((function e(){var t,n;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!localStorage.getItem("access")){e.next=14;break}return t={headers:{"Content-Type":"application/json",Accept:"application/json"}},n=JSON.stringify({token:localStorage.getItem("access")}),e.prev=3,e.next=6,_.a.post("http://localhost:8000/auth/jwt/verify",n,t);case 6:"token_not_valid"!==e.sent.data.code?s({type:m}):s({type:v}),e.next=14;break;case 10:e.prev=10,e.t0=e.catch(3),console.log("error on verifying token",e.t0),s({type:v});case 14:case"end":return e.stop()}}),e,null,[[3,10]])})));return function(){return e.apply(this,arguments)}}(),p=function(){var e=Object(d.a)(h.a.mark((function e(t,n,a,c,o){var r,i,u;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r={headers:{"Content-Type":"application/json"}},i=JSON.stringify({first_name:n,last_name:a,email:t,password:c,re_password:o}),e.prev=2,console.log(i),e.next=6,_.a.post("http://localhost:8000/auth/users/",i,r);case 6:u=e.sent,s({type:"SIGNUP_SUCCESS",payload:u.data}),e.next=14;break;case 10:e.prev=10,e.t0=e.catch(2),console.log(e.t0),s({type:"SIGNUP_FAIL"});case 14:case"end":return e.stop()}}),e,null,[[2,10]])})));return function(t,n,a,c,o){return e.apply(this,arguments)}}(),A=function(){var e=Object(d.a)(h.a.mark((function e(t,n){var a,c;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a={headers:{"Content-Type":"application/json"}},c=JSON.stringify({uid:t,token:n});try{_.a.post("http://localhost:8000/auth/users/activation/",c,a),s({type:w})}catch(o){console.log("Activation Failed",o),s({type:S})}case 3:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),U=function(){var e=Object(d.a)(h.a.mark((function e(){var t;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,_.a.get("http://localhost:8000/auth/o/google-oauth2/?redirect_uri=http://localhost:8000/auth/google");case 3:t=e.sent,window.location.replace(t.data.authorization_url),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.log(e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}}(),F=function(){var e=Object(d.a)(h.a.mark((function e(t,n){var a,c,o,r;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t||!n||localStorage.getItem("access")){e.next=17;break}return a={headers:{"Content-Type":"application/x-www-form-urlencoded"}},c={state:t,code:n},o=Object.keys(c).map((function(e){return encodeURIComponent(e)+"="+encodeURIComponent(c[e])})).join("&"),e.prev=4,console.log("posting to :",I+o),e.next=8,_.a.post(I+o,a);case 8:r=e.sent,console.log("authenticate google success ?",r.data),s({type:"GOOGLE_AUTH_SUCCESS",payload:r.data}),e.next=17;break;case 13:e.prev=13,e.t0=e.catch(4),console.log("authenticate google failed",e.t0),s({type:"GOOGLE_AUTH_FAIL"});case 17:case"end":return e.stop()}}),e,null,[[4,13]])})));return function(t,n){return e.apply(this,arguments)}}(),L=function(){var e=Object(d.a)(h.a.mark((function e(){var t;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,_.a.get("http://localhost:8000/auth/o/facebook/?redirect_uri=http://localhost:8000/auth/facebook");case 3:t=e.sent,window.location.replace(t.data.authorization_url),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.log("continue with facebook error",e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}}(),G=function(){var e=Object(d.a)(h.a.mark((function e(t,n){var a,c,o,r;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t||!n||localStorage.getItem("access")){e.next=17;break}return a={headers:{"Content-Type":"application/x-www-form-urlencoded"}},c={state:t,code:n},o=Object.keys(c).map((function(e){return encodeURIComponent(e)+"="+encodeURIComponent(c[e])})).join("&"),e.prev=4,console.log("posting to :",T+o),e.next=8,_.a.post(T+o,a);case 8:r=e.sent,console.log("authenticate facebook success ?",r.data),s({type:"FACEBOOK_AUTH_SUCCESS",payload:r.data}),e.next=17;break;case 13:e.prev=13,e.t0=e.catch(4),console.log("authenticate facebook failed",e.t0),s({type:"FACEBOOK_AUTH_FAIL"});case 17:case"end":return e.stop()}}),e,null,[[4,13]])})));return function(t,n){return e.apply(this,arguments)}}();return Object(a.jsx)(E.Provider,{value:{authState:r,login:i,loadUser:u,verifyTokenAuthenticated:l,logout:function(){s({type:y})},signup:p,activateAccount:A,continueWithGoogle:U,googleAuthenticate:F,continueWithFacebook:L,facebookAuthenticate:G},children:t})},F=function(){return Object(c.useContext)(E)},L=function(){var e=F(),t=e.authState,n=e.logout;return Object(a.jsxs)("nav",{children:[Object(a.jsx)(i.b,{to:"/",children:"Home"}),Object(a.jsx)(i.b,{to:"/login",children:"Login"}),Object(a.jsx)("a",{href:"",onClick:function(e){console.log("logging out"),n()},children:"Logout"}),t.user&&Object(a.jsxs)(a.Fragment,{children:[Object(a.jsx)("h1",{children:t.user.email}),Object(a.jsx)("h2",{children:t.user.first_name+" "+t.user.last_name})]})]})},G=n(15),N=function(){var e=F(),t=e.login,n=e.authState,o=Object(c.useState)({email:"",password:""}),r=Object(b.a)(o,2),s=r[0],i=r[1],l=s.email,p=s.password,h=function(e){return i(Object(j.a)(Object(j.a)({},s),{},Object(G.a)({},e.target.name,e.target.value)))};return n.isAuthenticated?Object(a.jsx)(u.a,{to:"/"}):Object(a.jsx)("div",{children:Object(a.jsxs)("form",{onSubmit:function(e){return function(e){e.preventDefault(),t(l,p),console.log("from onclick",n)}(e)},children:[Object(a.jsx)("input",{type:"text",placeholder:"email",name:"email",value:l,onChange:function(e){return h(e)},required:!0,autoComplete:"email"}),Object(a.jsx)("input",{type:"password",placeholder:"password",name:"password",value:p,onChange:function(e){return h(e)},required:!0,autoComplete:"current-password"}),Object(a.jsx)("button",{type:"submit",children:"Login"})]})})},H=function(){var e=F(),t=e.signup,n=e.authState,o=e.continueWithGoogle,r=e.continueWithFacebook,s=Object(c.useState)(!1),i=Object(b.a)(s,2),l=i[0],p=i[1],h=Object(c.useState)({email:"",password:"",re_password:"",first_name:"",last_name:""}),d=Object(b.a)(h,2),f=d[0],O=d[1],g=f.email,x=f.password,m=f.re_password,v=f.first_name,y=f.last_name,w=function(e){return O(Object(j.a)(Object(j.a)({},f),{},Object(G.a)({},e.target.name,e.target.value)))};return n.isAuthenticated?Object(a.jsx)(u.a,{to:"/"}):l?Object(a.jsx)(u.a,{to:"/login"}):Object(a.jsxs)("div",{children:[Object(a.jsxs)("form",{onSubmit:function(e){return function(e){e.preventDefault(),t(g,v,y,x,m),p(!0)}(e)},children:[Object(a.jsx)("input",{type:"text",placeholder:"email",name:"email",value:g,onChange:function(e){return w(e)},required:!0,autoComplete:"email"}),Object(a.jsx)("input",{type:"password",placeholder:"password",name:"password",value:x,onChange:function(e){return w(e)},required:!0,autoComplete:"new-password"}),Object(a.jsx)("input",{type:"password",placeholder:"re-type password",name:"re_password",value:m,onChange:function(e){return w(e)},required:!0,autoComplete:"new-password"}),Object(a.jsx)("input",{type:"text",placeholder:"first name",name:"first_name",value:v,onChange:function(e){return w(e)},required:!0}),Object(a.jsx)("input",{type:"text",placeholder:"last name",name:"last_name",value:y,onChange:function(e){return w(e)},required:!0}),Object(a.jsx)("button",{type:"submit",children:"Register"})]}),Object(a.jsx)("button",{onClick:function(e){return o()},children:"Continue With Google"}),Object(a.jsx)("button",{onClick:function(e){return r()},children:"Continue With Facebook"})]})},R=function(){var e=F().authState;return Object(a.jsxs)("div",{children:[Object(a.jsx)("h1",{children:"Login"}),Object(a.jsx)(N,{}),e.loginFail&&Object(a.jsx)("p",{children:"Wrong password or username is inserted"}),Object(a.jsx)("h1",{children:"Signup"}),Object(a.jsx)(H,{})]})},W=function(e){var t=e.match,n=t.params.uid,o=t.params.token,r=F(),s=r.activateAccount;r.authStates;return Object(c.useEffect)((function(){s(n,o)}),[]),Object(a.jsxs)("div",{children:["Your Account has been Activate ! Sending id : ",o," and token : ",n,Object(a.jsx)("p",{children:"Go back to"}),Object(a.jsx)(i.b,{to:"/",children:"Home"})]})},q=function(){return Object(a.jsx)("div",{children:"Page not found"})},J=n(18),D=n.n(J),P=function(){var e=Object(u.g)(),t=F(),n=t.googleAuthenticate,o=t.authState;return Object(c.useEffect)((function(){var t=D.a.parse(e.search),a=t.state?t.state:null,c=t.code?t.code:null;a&&c&&n(a,c)}),[e]),o.isAuthenticate?Object(a.jsx)(u.a,{to:"/"}):Object(a.jsx)("div",{children:"Authenticting with Google"})},z=function(){var e=Object(u.g)(),t=F(),n=t.facebookAuthenticate,o=t.authState;return Object(c.useEffect)((function(){var t=D.a.parse(e.search),a=t.state?t.state:null,c=t.code?t.code:null;a&&c&&n(a,c)}),[e]),o.isAuthenticate?Object(a.jsx)(u.a,{to:"/"}):Object(a.jsx)("div",{children:"Authenticting with Facebook"})};var B=function(){var e=F(),t=e.verifyTokenAuthenticated,n=e.loadUser;return Object(c.useEffect)((function(){t(),n()}),[]),Object(a.jsxs)(i.a,{children:[Object(a.jsx)(L,{}),Object(a.jsx)("div",{className:"App",children:Object(a.jsxs)(u.d,{children:[Object(a.jsx)(u.b,{exact:!0,path:"/",component:l}),Object(a.jsx)(u.b,{exact:!0,path:"/login",component:R}),Object(a.jsx)(u.b,{exact:!0,path:"/activate/:uid/:token",component:W}),Object(a.jsx)(u.b,{exact:!0,path:"/auth/google",component:P}),Object(a.jsx)(u.b,{exact:!0,path:"/auth/facebook",component:z}),Object(a.jsx)(u.b,{component:q})]})})]})},K=n(35),V=document.getElementById("root");s.a.render(Object(a.jsx)(o.a.StrictMode,{children:Object(a.jsx)(U,{children:Object(a.jsx)(B,{})})}),V),Object(K.a)(V)}},[[81,1,2]]]);
//# sourceMappingURL=main.0001de14.chunk.js.map